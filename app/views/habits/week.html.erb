<% time = Time.new %>

<div class="col-md-8">

<div class="row">
	<div class="col-md-3">
		<!-- <button type="button" class="btn btn-lg btn-default">Previous Week</button> -->
		<%= link_to "Previous Week", previousWeek_checkins_path %>
	</div>
	<div class="col-md-6">
		<h2>Week starting <%= "#{(Time.now - 7.days).strftime("%B %d")}" %></h2>
	</div>
	
	<div class="col-md-3">
			<!-- <button type="button" class="btn btn-lg btn-default">Next Week</button> -->
			<%= link_to "Next Week", nextWeek_checkins_path %>

	</div>
</div>

<table class="table table-bordered">
	<thead>
		<tr>
			<th>Habit</th>
			<% Checkin.endDay.upto(Checkin.startDay) do |d| %> <!-- this is last 7 days, not the current week -->
				<th><%= "#{(Time.now - d.days).strftime("%a - %d")}" %></th>
			<% end %>
		</tr>
	</thead>
	<tbody>
		<% @habits.each do |h| %>
			<tr>
				<!-- if active -->
				<td><h2><div class="label label-default"><%= h.name %></span></h2></td>
				<%=  %>
				<% checkins_this_week = h.checkins.last(7) %>
				<% checkins_this_week.reverse! %>
				<% 0.upto(checkins_this_week.count - 1) do |n| #checkins_this_week.reverse_each do |c| %>
					<% iterDate = (Time.now - n.to_i.days).strftime("%B %d") %>
					
					<% if checkins_this_week[n].date.to_s.include? iterDate %>
						<% if checkins_this_week[n].status == "green" %>
							<td bgcolor="00cc00">
						<% elsif checkins_this_week[n].status == "yellow" %>
							<td bgcolor="ffff00">
						<% elsif checkins_this_week[n].status == "red" %>
							<td bgcolor="ff0000">
						<% else %>
							problem
						<% end %>
					<% else %>
						<td bgcolor="0000ff">No data.
					<% end %>
					</td>
					<%# n += 1 %>
				<% end %>
				<% checkins_this_week.count.upto(6) do |n| %>
					<td bgcolor="0000ff">No data.
				<% end %>
			</tr>
		<% end %>
	</tbody>
</table>

<h3><p><%= link_to "Add a new habit", new_habit_path %></p></h3>

</div>

